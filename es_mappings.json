{
  "t_behavior": {
    "mappings": {
      "properties": {
        "project_id": { "type": "long" },
        "description": {
          "type": "text",
          "analyzer": "ik_max_word"
        },
        "type": { "type": "keyword" },
        "dimension": { "type": "keyword" },
        "tags": { "type": "keyword" },
        "status": { "type": "keyword" },
        "quantitative_data": { "type": "double" },
        "behavior_date": { "type": "date" },
        "description_vector": {
          "type": "dense_vector",
          "dims": 768
        },
        "created_at": { "type": "date" }
      }
    }
  },
  "t_indicator": {
    "mappings": {
      "properties": {
        "name": {
          "type": "text",
          "analyzer": "ik_max_word",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "description": {
          "type": "text",
          "analyzer": "ik_max_word"
        },
        "type": { "type": "keyword" },
        "indicator_level": { "type": "integer" },
        "parent_indicator_id": { "type": "keyword" },
        "dimension": { "type": "keyword" },
        "industry": { "type": "keyword" },
        "region": { "type": "keyword" },
        "tags": { "type": "keyword" },
        "max_score": { "type": "double" },
        "calculation_rule": {
          "type": "object",
          "properties": {
            "rule_type": { "type": "keyword" },
            "binary_rule": {
              "type": "object",
              "properties": {
                "condition": { "type": "text" },
                "true_score": { "type": "double" },
                "false_score": { "type": "double" }
              }
            },
            "range_rule": {
              "type": "object",
              "properties": {
                "min_value": { "type": "double" },
                "max_value": { "type": "double" },
                "calculation_method": { "type": "keyword" },
                "out_of_range_score": { "type": "double" },
                "max_score": { "type": "double" }
              }
            }
          }
        },
        "default_calculation_rule": {
          "type": "object",
          "properties": {
            "rule_type": { "type": "keyword" },
            "binary_rule": {
              "type": "object",
              "properties": {
                "condition": { "type": "text" },
                "true_score": { "type": "double" },
                "false_score": { "type": "double" }
              }
            },
            "range_rule": {
              "type": "object",
              "properties": {
                "min_value": { "type": "double" },
                "max_value": { "type": "double" },
                "calculation_method": { "type": "keyword" },
                "out_of_min_score": { "type": "double" },
                "out_of_max_score": { "type": "double" }
              }
            }
          }
        },
        "risk_rule": {
          "type": "object",
          "properties": {
            "description": {"type": "keyword"},
            "static_threshold": {
              "type": "object",
              "properties": {
                "operator": { "type": "keyword" },
                "threshold_value": { "type": "double" },
                "risk_level": { "type": "keyword" }
              }
            },
            "adjustment_factor": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean" },
                "required_low_count": { "type": "integer" },
                "risk_level_increase": { "type": "keyword" }
              }
            }
          }
        },
        "questionnaire_form": {
          "type": "object",
          "properties": {
            "question_type": { "type": "keyword" },
            "question_text": {"type": "keyword"},
            "input_type": { "type": "keyword" },
            "validation_rules": {
              "type": "object",
              "properties": {
                "min_length": { "type": "integer" },
                "max_length": { "type": "integer" },
                "min_value": { "type": "double" },
                "max_value": { "type": "double" },
                "pattern": { "type": "keyword" },
                "custom_validation": { "type": "text" }
              }
            },
            "options": {
              "type": "nested",
              "properties": {
                "value": { "type": "keyword" },
                "label": {
                  "type": "text",
                  "analyzer": "ik_max_word"
                },
                "score_mapping": { "type": "double" },
                "is_default": { "type": "boolean" }
              }
            },
            "help_text": {
              "type": "text",
              "analyzer": "ik_max_word"
            },
            "placeholder": {
              "type": "keyword"
            }
          }
        },
        "name_vector": {
          "type": "dense_vector",
          "dims": 768
        },
        "created_at": { "type": "date" }
      }
    }
  },
  "t_regulation": {
    "mappings": {
      "properties": {
        "name": {
          "type": "text",
          "analyzer": "ik_max_word",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "type": { "type": "keyword" },
        "dimension": { "type": "keyword" },
        "industry": { "type": "keyword" },
        "region": { "type": "keyword" },
        "applicable_subject": { "type": "keyword" },
        "full_text": {
          "type": "text",
          "analyzer": "ik_max_word"
        },
        "direction": { "type": "keyword" },
        "quantitative_indicator": { "type": "double" },
        "full_text_vector": {
          "type": "dense_vector",
          "dims": 768
        },
        "created_at": { "type": "date" }
      }
    }
  },
  "t_risk": {
    "mappings": {
      "properties": {
        "project_id": { "type": "long" },
        "assessment_id": { "type": "long" },
        "name": {
          "type": "text",
          "analyzer": "ik_max_word",
          "fields": { "keyword": { "type": "keyword" } }
        },
        "dimension": { "type": "keyword" },
        "description": {
          "type": "text",
          "analyzer": "ik_max_word"
        },
        "risk_level": { "type": "keyword" },
        "probability": { "type": "integer" },
        "impact": { "type": "integer" },
        "detectability": { "type": "integer" },
        "status": { "type": "keyword" },
        "responsible_party": { "type": "keyword" },
        "affected_objects": { "type": "keyword" },
        "impact_scope": { "type": "keyword" },
        "countermeasures": {
          "type": "text",
          "analyzer": "ik_max_word"
        },
        "triggered_by_rule": {
          "type": "object",
          "properties": {
            "rule_id": { "type": "keyword" },
            "rule_description": { "type": "text" },
            "trigger_condition": { "type": "text" }
          }
        },
        "related_indicators": {
          "type": "nested",
          "properties": {
            "indicator_es_id": { "type": "keyword" },
            "indicator_name": { "type": "text" },
            "score": { "type": "double" },
            "threshold": { "type": "double" },
            "is_primary_trigger": { "type": "boolean" }
          }
        },
        "related_regulations": {
          "type": "nested",
          "properties": {
            "regulation_es_id": { "type": "keyword" },
            "regulation_name": { "type": "text" },
            "violation_type": { "type": "keyword" },
            "compliance_requirement": { "type": "text" }
          }
        },
        "created_at": { "type": "date" }
      }
    }
  }
}
